---
title: "GitHub Demo"
author: "Huda Akef"
date: "4/7/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Brief Introduction to Git and GitHub

### clean up!
```{r clear-workspace}

rm(list=ls())

```

### get all the packages in...

```{r function-check-for-packages, include=FALSE}

# make sure we can load packages 
# (thanks to https://gist.github.com/smithdanielle/9913897)
load_or_install_packages <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
  if (length(new.pkg)) 
    install.packages(new.pkg, 
                     dependencies = TRUE,
                     repos="http://cloud.r-project.org/")
  sapply(pkg, require, character.only = TRUE)
}

```


```{r load-packages, message=FALSE, results="hide"}
# specify which packages we'll need
required_packages = c("tidyverse",
                      "stringr",
                      "dplyr",
                      "usethis",
                      "gitcreds"
                      )

# install them (if necessary) and load them
load_or_install_packages(required_packages)
```

*******

The following sections demonstrate how you can use Git and GitHub with RStudio. This will enable you to track changes across an R Project (which will function as a repository).
*Source*: https://rfortherestofus.com/2021/02/how-to-use-git-github-with-r/ 

*******

## Making sure Git works on your computer

We first need to install Git if needed, Macs come with Git installed by default. You might need to install Command Line Tools to be able to use Git commands. 


## Configuring and Initializing Git for R Studio

Next, we can configure git, but first editing the .gitconfig file, then initializing a Git repository to an RStudio project. You can do this by either:

  * checking the Git box when creating a project
  * running the use_git() function below

```{r configuring git}

# this doesn't typically need to be in any saved code or RMarkdown files, you just need to run it once

edit_git_config()

use_git()

```

You can now see that there's a Git Tab open near the Environment and History tabs. That's where you'll be able to see the history of any changes to your code.When you navigate to the Git tab, you can select History and that will open up a window showing the history of all your commits.

## Let's get it to track changes!

Git will not automatically track changes, so you have to tell it when you made changes so it can keep a record of them. This is what we call making a commit. Always include a meaningful commit message so it makes sense when you view it in the history. 

**Any time you make additional changes you want to keep a record of:**

* To do this, you must have made any changes since your last commit. Otherwise, you won't see the files that you made changes to listed in the Git tab.
* Make sure you save the file you made changes to. Go to the Git tab and click on "Commit"
* This will open up a window where you can select the file you want to commit, and write a commit message. 
* Once that's complete, you'll be able to view the changes in the history. 

*******

## Connecting Rstudio Projects with GitHub Repositories

1. The first thing you need to do is sign up for a GitHub account (free) if you don't already have one.
2. Create a Personal Access Token (PAT) on GitHub, you'll need this along with your username.
3. Store your PAT and connect to GitHub

```{r create PAT & connect to GitHub}

# you can also just do this in the console since it only needs to be done once

create_github_token()  # this will navigate to GitHub in your browser

# you'll need to write a note to name the token and then generate the token, and copy the PAT - you won't see it again

# paste your PAT in the placeholder below to save it in R
# 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

PAT_H <- "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"

# this function is from the library (gitcreds), enter PAT as password in the console after running command

gitcreds_set()

```

Now, that we've connected to GitHub, we'll connect our project to a GitHub repo -- note that each RStudio Project lives in a single GitHub repo. We can get this started here in RStudio or on GitHub. Here's how to do it here -- it's also just one line of code that navigates to GitHub to where your new repo is.

**Before running this, make sure you've committed all changes so they're copied into the repo**

```{r create GitHub repo}

use_github()

```
